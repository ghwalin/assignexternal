define("mod_assignexternal/grader_navigation",["exports","./repository"],(function(_exports,_repository){Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0;_exports.init=()=>{loadAllStudents().then((()=>{document.getElementById("user_autocomplete_downarrow").addEventListener("click",toggleUserlist),document.getElementById("user_autocomplete_input").addEventListener("input",filterUserlist),document.getElementById("user_autocomplete_suggestions").addEventListener("click",selectUser),document.getElementById("previous-user").addEventListener("click",navigateUser),document.getElementById("next-user").addEventListener("click",navigateUser)}))};const loadAllStudents=async()=>{const courseid=document.getElementsByName("courseid")[0].value,response=await(0,_repository.fetchAllStudents)(courseid);let dropdown=document.getElementById("change-user-select"),datalist=document.getElementById("user_autocomplete_suggestions");const queryString=window.location.search,currentId=new URLSearchParams(queryString).get("userid");for(let i=0;i<response.length;i++)addStudents(response[i],dropdown,datalist,currentId)};function addStudents(student,dropdown,datalist,currentStudentId){let option=document.createElement("option");option.text=student.firstname+" "+student.lastname,option.value=student.userid,dropdown.add(option);let item=document.createElement("li");item.id="user_autocomplete_suggestion_"+student.userid,item.innerHTML=student.firstname+" "+student.lastname+" <small>"+student.email+"</small>",item.setAttribute("data-value",student.userid),student.userid==currentStudentId&&(item.setAttribute("aria-selected","true"),datalist.setAttribute("data-currentItem",datalist.childElementCount)),item.setAttribute("role","option"),datalist.appendChild(item)}function toggleUserlist(){let userlist=document.getElementById("user_autocomplete_suggestions");"none"===userlist.style.display?(userlist.style.display="inline",document.getElementById("user_autocomplete_input").focus()):userlist.style.display="none"}function filterUserlist(){const filter=document.getElementById("user_autocomplete_input").value.toUpperCase(),userlist=document.getElementById("user_autocomplete_suggestions"),users=userlist.getElementsByTagName("li");userlist.style.display="inline";for(const user of users){const value=user.innerText.toUpperCase();""===filter||value.includes(filter)?user.style.display="block":user.style.display="none"}}function selectUser(event){let element=event.target;if(event.target){"SMALL"===event.target.nodeName&&(element=event.target.parentNode);const queryString=window.location.search,urlParams=new URLSearchParams(queryString);urlParams.set("userid",element.getAttribute("data-value")),window.location.href="?"+urlParams.toString()}}function navigateUser(event){const datalist=document.getElementById("user_autocomplete_suggestions"),children=datalist.getElementsByTagName("LI");let currentItem=datalist.getAttribute("data-currentitem");"previous-user"===event.target.id?"0"===currentItem?currentItem=children.length-1:currentItem--:currentItem>=children.length-1?currentItem=0:currentItem++;const userid=children[currentItem].getAttribute("data-value"),queryString=window.location.search,urlParams=new URLSearchParams(queryString);urlParams.set("userid",userid),window.location.href="?"+urlParams.toString()}}));

//# sourceMappingURL=grader_navigation.min.js.map